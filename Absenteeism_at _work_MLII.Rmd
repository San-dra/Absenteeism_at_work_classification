---
title: "Predicting Absenteeism at work"
subtitle: "Machine Learning II"
author: "Sandra Alemayehu & Jessica Hayek"
date: "21 February 2020"
output: html_document

---

```{r, message=FALSE, warning=FALSE, include=FALSE}
library(MASS)
library(ISLR)
library(rpart)
library(rpart.plot)
library(randomForest)
library(ggplot2)
library(e1071)     
library(glmnet)
library(caret)     
library(FSelector)
library(dplyr)
library(knitr)
library(magrittr)
library(lattice)
library(skimr)
```

#Introduction
The main goal is to **predict whether or not an individual is going to have a long absence** (`Absenteeism` variable) it's therefore a binary classification problem.

#Data Loading and Overview


```{r Loading Training}

abs_training_df<-read.csv("C:/Users/sandr/Desktop/Machine Learning II/ML Assignment/Absenteeism_at_work_classification/Absenteeism_at_work_classification_training.csv",sep = ";")
ncol(abs_training_df)

abs_test_df = read.csv(file = file.path("C:/Users/sandr/Desktop/Machine Learning II/ML Assignment/Absenteeism_at_work_classification/Absenteeism_at_work_classification_test.csv"),  header = TRUE, dec = ".", sep = ";")
```

##Variable Type
```{r Variables}
data.frame(Variable = names(abs_training_df),
           Class = sapply(abs_training_df, typeof),
           First_values = sapply(abs_training_df, function(x) paste0(head(x),  collapse = ", ")),
           row.names = NULL) %>% kable()
```

The dataframe contains **22** variables.The target variable is **Absenteeism**, a logical variable setting categorizing whether an individual is going to be absent more than 5 hours in total.

##Data overview

```{r Training Dataset Overview, echo=FALSE}
skim(abs_training_df)
```

#Data Cleaning and Preparation
From the data overview we can identify there target variable is sufficiently balanced in training set with 63% False and 47% True. We also dont have any missing values.
However we do have variable which are codified as numbers which are supposed to be categorical and possible outliers in few variables such as age and transportation cost.

##Changing Data Type
We can see from the attribute information (https://archive.ics.uci.edu/ml/datasets/Absenteeism+at+work) that 11 categorical variables have been codified as number in our dataframe. These variables are: **ID**, **ID.Worker**, **Reason.for.absence**, **Month.of.absence**, **Day.of.the.week**, **Seasons**, **Disciplinary.failure**, **Education**, **Social.drinker**, **Social.smoker**,**Absenteeism** 
Before converting these these variables need to combine test dataset with train dataset, and apply the conversion on both. 

```{r Combine Dataset, echo=FALSE}
abs_test_df$Absenteeism <- 0  #add taget variable Absenteeism into the test dataset
abs_dataset <- rbind(abs_training_df, abs_test_df)
str(abs_dataset) #check dataset
```
We can now convert all the categorical variables to factors. 
```{r Converting Variables, echo=FALSE}
categorical_variables <- c('ID', 'ID.Worker','Education','Reason.for.absence', 'Month.of.absence', 'Day.of.the.week', 'Seasons', 'Disciplinary.failure', 'Social.drinker', 'Social.smoker', 'Absenteeism')
abs_dataset[categorical_variables] <- lapply(abs_dataset[categorical_variables], factor) 
str(abs_dataset)
```

To facilitate the understanding of the feature analysis, I am going to change the name of some of them to their actual meaning (this meaning is in the dataset description file).

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
